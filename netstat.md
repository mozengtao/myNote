### netstat -an
> "netstat -an“ shows the **state** of **all socket connections**

```sh
# netstat -an

Active Internet connections (including servers)  
Proto Recv-Q Send-Q  Local Address          Foreign Address        state  
tcp        0      0  *.111                  *.*                    LISTEN  
tcp4       0      0  100.300.0.35.10022     100.300.0.173.45521    ESTABLISHED  
tcp4       0      0  100.300.0.35.10022     100.300.0.173.21028    ESTABLISHED  
tcp        0      0  *.657                  *.*                    LISTEN
```

#### fields explanation
-   **Proto** : The protocol (tcp, udp, raw) used by the socket.
-   **Recv-Q** : The count of bytes not copied by the user program connected to this socket.
-   **Send-Q** : The count of bytes not acknowledged by the remote host.
-   **Local Address** : The address and port number of the local end of the socket.
-   **Foreign Address** : The address and port number of the remote end of the socket.
-   **State** : The state of the socket.
	- **ESTABLISHED** : The socket has an established connection.
	- **SYN_SENT** : The socket is actively attempting to establish a connection.
	- **SYN_RECV** : A connection request has been received from the network.
	- **FIN_WAIT1** : The socket is closed, and the connection is shutting down.
	- **FIN_WAIT2** : Connection is closed, and the socket is waiting for a shutdown from the remote end.
	- **TIME_WAIT** : The socket is waiting after close to handle packets still in the network.
	- **CLOSE** : The socket is not being used.
	- **CLOSE_WAIT** : The remote end has shut down, waiting for the socket to close. 
	- **LAST_ACK** : The remote end has shut down, and the socket is closed. Waiting for acknowledgment. 
	- **LISTEN** : The socket is listening for incoming connections.
	- **CLOSING** : Both sockets are shut down but we still don’t have all our data sent.
	- **UNKNOWN** : The state of the socket is unknown.

### netstat -nr
> displays the kernel routing table

```sh
# netstat -nr
Kernel IP routing table
Destination   Gateway      Genmask         Flags  MSS Window  irtt Iface
127.0.0.1     *            255.255.255.255 UH       0 0          0 lo
172.16.1.0    *            255.255.255.0   U        0 0          0 eth0
172.16.2.0    172.16.1.1   255.255.255.0   UG       0 0          0 eth0
```

#### fields explanation
- **Destination**: 
- **Gateway**: the gateway to which the routing entry points
- **Genmask**: the network mask for this route, When given an IP address to find a suitable route for, the kernel steps through each of the routing table entries, taking the bitwise **AND** of the **address** and the **genmask** **before** comparing it to the target of the route
- **Flags**: 
	- **G**: The route uses a gateway.
	- **U**: The **interface** to be used is **up**.
	- **H**: **Only** a **single** **host** can be reached through the route. For example, this is the case for the loopback entry 127.0.0.1
	- **D**: This route is **dynamically** **created**. It is set if the table entry has been generated by a routing daemon like **gated** or by an ICMP redirect message
	- **M**: This is set if the table entry was modified by an ICMP redirect message.
	- **!**: The route is a reject route and datagrams will be dropped
- **MSS**(Maximum Segment Size): the size of the largest datagram the kernel will construct for transmission via this route
- **Window**: the maximum amount of data the system will accept in a single burst from a remote host
- **irtt**(initial round trip time): the value that the TCP protocol will use when a connection is first established
- **Iface**: network interface


**initial round trip time:** The TCP protocol ensures that data is reliably delivered between hosts by retransmitting a datagram if it has been lost. The TCP protocol keeps a running count of how long it takes for a datagram to be delivered to the remote end, and an acknowledgement to be received so that it knows how long to wait before assuming a datagram needs to retransmitted; this process is called the round-trip time. The initial round-trip time is the value that the TCP protocol will use when a connection is first established.


### netstat -i
> Displaying Interface Statistics

```sh
# netstat -i
Kernel Interface table
Iface MTU Met  RX-OK RX-ERR RX-DRP RX-OVR  TX-OK TX-ERR TX-DRP TX-OVR Flags
lo      0   0   3185      0      0      0   3185      0      0      0 BLRU
eth0 1500   0 972633     17     20    120 628711    217      0      0 BRU
```

#### fields explanation
- **Iface**: interface name
- **MTU**: MTU value for the interface
- **Met**: metric values for the interface
- **RX-OK**: how many packets have been received error-free
- **RX-ER**: how many packets have been received damaged
- **RX-DR**: how many packets have been received dropped
- **RX-OV**: how many packets have been received overrun
- **TX-OK**: how many packets have been transmitted error-free
- **TX-ER**: how many packets have been transmitted damaged
- **TX-DR**: how many packets have been transmitted dropped
- **TX-OV**: how many packets have been transmitted overrun
- **Flags**: 
	- **B**: A broadcast address has been set.
	- **L**: This interface is a loopback device.
	- **M**: All packets are received (promiscuous mode).
	- **O**: ARP is turned off for this interface.
	- **P**: This is a point-to-point connection.
	- **R**: Interface is running.
	- **U**: Interface is up


### Netstat Command Practical Examples
1. **To list all the LISTENING Ports of TCP and UDP connections**
	1. `netstat -a`
2. **To list all the TCP Ports connections**
	1. `netstat -at`
3. **To list all the UDP Ports connections**
	1. `netstat -au`
4. **To list all listening port connections**
	1. `netstat -l`
5. **To list all TCP listening Ports**
	1. `netstat -lt`
6. **To list all UDP listening Ports**
	1. `netstat -lu`
7. **To list all UNIX Listening Ports**
	1. `netstat -lx`
8. **To list the statistics for all ports**
	1. `netstat -s`
9. **To list the statistics for TCP (or) UDP ports**
	1. `netstat -st(u)`
10. **To display service name with PID**
	1. `netstat -tp`
11. **To display the kernel routing information**
	1. `netstat -r`
12. **To find listening ports**
	1. `netstat -ap | grep ssh`
13. **To list of network interfaces**
	1. `netstat -ie`
14. **To show which process is using a particular port**
	1. `netstat -anlp | grep 80`